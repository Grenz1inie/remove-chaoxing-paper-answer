# 超星学习通期末周复习小助手

窝趣！考试只剩一周了怎么办！\
希望该Script能像热带风味冰红茶一样温润同学们不安的心~

><mark>**项目永久开源，谨以此致敬素未谋面的恩人软院期末开源祖师cg学长**</mark>

## 🚀 主要功能（支持桌面端/移动端）

>Script生效范围：超星学习通作业浏览界面（https://\*.chaoxing.com/mooc-ans/mooc2/work/view\*）

1. **🤖 智能AI助手** - 可定制提示词的一键问豆包AI，自动跨域提问（基于Web自动化，而非传统的调用模型API或题库检索）
2. **👁️ 答案控制** - 灵活的显示/隐藏答案，方便二刷、三刷、甚至多刷
3. **⭐ 错题标记** - 错题记录系统，错的越多星级越高，方便重点复习
4. **📝 本地笔记** - 本地持久化存储的富文本笔记，随时记下知识点或解析且无需担心丢失
5. **📄 高级导出** - 可定制的导出所有作业题目功能（支持选择导出得分、答案、解析等），快速生成刷题集或背题手册
6. **⚙️ 深度自定义** - 除提供高可用的默认配置外，还设有控制面板作为配置管理入口，对上述所有功能进行深度定制

>Script仍处于开发阶段，尚有很多不足之处，诚挚且热烈欢迎各位大佬进行PR或Issues。

---

## 🧩 安装方式
### 方式一：从 Greasy Fork 安装（需要翻墙）
1. 安装浏览器插件 [Tampermonkey](https://www.tampermonkey.net)
2. 点击以下链接直接安装：  
   👉 [**直接安装脚本**](https://update.greasyfork.org/scripts/555192/超星学习通期末周复习小助手.user.js)

### 方式二：从 ScriptCat 安装（无需翻墙）
1. 安装浏览器插件 [ScriptCat](https://scriptcat.org/zh-CN)
2. 点击以下链接直接安装：  
   👉 [**直接安装脚本**](https://scriptcat.org/scripts/code/4822/超星学习通期末周复习小助手.user.js)


---

## 🖼️ 预览图

<img src="https://cdn.jsdelivr.net/gh/Grenz1inie/remove-chaoxing-paper-answer@main/images/1.png" alt="预览1" width="50%">
<img src="https://cdn.jsdelivr.net/gh/Grenz1inie/remove-chaoxing-paper-answer@main/images/2.png" alt="预览2" width="50%">

---

## ✨ 最新版本特性 (v3.9.1.3)

### 🐛 Bug 修复
- **控制面板下边栏优化**：修复下边栏未紧贴窗口底部的问题
  - 重构内容区域布局，使用flex布局确保下边栏始终贴底
  - 为所有设置面板添加内容包装器（contentWrapper）
  - 下边栏改用`marginTop: auto`实现自动底部定位
  - 移除负margin hack，使用现代flex布局方案

### 👍 UI/UX 优化
- **笔记子选项卡增强**：激活状态的子选项卡添加粗体+发光效果
  - 当前页面/当前课程/当前域名选中时显示粗体
  - 添加蓝色发光效果，提升视觉识别度和用户体验

### 🔧 技术优化
- **布局重构**：统一所有设置面板的布局结构
  - 基础设置、复制配置、AI提问、导出设置均使用contentWrapper
  - 确保内容区域有padding，下边栏紧贴底部
  - 提升代码一致性和可维护性

---

## 📦 核心功能

### 🎯 答案控制
- **单个控制**：每道题目独立的显示/隐藏按钮
- **全局控制**：一键显示/隐藏所有答案

### 🤖 智能AI助手
- **一键问豆包**：点击"🤖 问豆包"按钮，自动提取题目内容
- **跨域提问**：自动打开豆包AI并填充题目到输入框
- **自动发送**：题目填充后自动点击发送，无需手动操作
- **移动端优化**：智能识别设备类型，移动端固定等待3秒确保稳定
- **会话复用**：智能检测已有对话窗口，优先复用

### 📋 题目复制
- **一键复制**：每道题目独立的复制按钮，支持图片复制
- **富文本格式**：使用 HTML 格式复制，保留排版和图片
- **前缀配置**：自定义复制内容的前缀（默认无）
- **后缀配置**：自定义复制内容的后缀（默认无）
- **实时预览**：设置面板中查看配置效果

### 📝 富文本笔记
- **16 个格式按钮**：粗体、斜体、下划线、删除线、标题(H1-H3)、有序/无序列表、引用、链接、代码、分隔线、撤销/重做、清除格式
- **编辑/预览模式**：支持预览格式化笔记内容
- **自动保存**：输入停止后自动保存（可配置）

### ⭐ 错题标记
- **错题+1按钮**：每题左上角添加"错题+1"按钮，一键记录做错次数
- **星级显示**：按钮下方显示错题次数对应的星星（⭐），每5颗星换行
- **自动加载**：打开页面自动加载历史错题记录，星星数量持久化
- **详细记录**：记录每次做错的时间戳，方便追踪学习进度

### 📄 试题导出
- **灵活格式选择**：在导出设置中配置DOC或DOCX格式
- **DOC格式（默认）**：兼容性更好，适合手机/平板直接查看
- **DOCX格式**：标准Office文档，桌面端推荐（手机/平板可能有显示bug）
- **2按钮导出**：导出试题（无答案）/ 导出答案（含答案）
- **多题型支持**：单选题、多选题、完型填空等
- **图片处理**：自动下载嵌入，超宽自动缩放
- **内容可选**：我的答案、正确答案、得分、解析可独立开关
- **配置持久化**：所有导出设置保存到IndexedDB

### 🎨 样式自定义
- **6 按钮管理**：答案、笔记、编辑、保存、全局、控制面板按钮样式统一管理
- **完整配置**：位置、尺寸、颜色、悬停效果等 10+ 配置项
- **持久化存储**：样式配置保存到 IndexedDB

---

## 📜 完整更新日志

### v3.9.1.3 (2025-12-09) 🐛 控制面板布局修复
- **控制面板下边栏优化**：修复下边栏未紧贴窗口底部的问题
- **布局重构**：使用flex布局确保下边栏始终贴底，所有设置面板添加contentWrapper
- **笔记子选项卡增强**：激活状态添加粗体+蓝色发光效果，提升视觉识别度

### v3.9.1.2 (2025-12-09) 🐛 按钮状态修复
- **笔记按钮状态修复**：修复点击后颜色未立即变为紫色的问题
- **编辑按钮颜色修复**：修正编辑/预览按钮颜色逻辑
- **错题按钮样式统一**：将错题按钮悬停效果统一到StyleGenerator管理
- **新增`addNoColorChangeHoverEffect`方法**：为按钮添加悬停动画但不改变背景色

### v3.9.1.1 (2025-12-09) 🐛 豆包自动发送修复
- **豆包自动发送修复**：修复未指定会话ID时豆包页面不自动发送的问题
- **间距优化**：统一错题按钮和星星的间距为2px
- **星星弹性布局**：改进星星容器布局逻辑，使用flexbox自动撑开空间

### v3.9.1 (2025-12-09) 👍 错题按钮UI优化
- **错题按钮位置优化**："错题+1"按钮移至题目上方，更符合视觉逻辑
- **星星动态布局**：星星显示在按钮和题目之间，点击时按钮平滑上移腾出空间
- **相对定位**：错题按钮改为相对定位，自然融入题目流

### v3.9.0 (2025-12-09) ⭐ 错题记录功能
- **错题+1按钮**：每题左上角添加"错题+1"按钮，一键记录做错次数
- **星级显示**：按钮下方显示错题次数对应的星星（⭐），每5颗星换行
- **笔记键结构优化**：新增题号字段，格式为`CourseId_ClassId_WorkId_QuestionId_QuestionNo`
- **数据库升级至v4**：新增mistakes store用于错题记录

### v3.8.5.2 (2025-12-09) 📝 导出格式配置化
- **格式配置化**：在导出设置中选择DOC或DOCX格式，告别多余按钮
- **简化UI**：删除手机版按钮，统一为2个导出按钮（试题/答案）
- **配置持久化**：导出格式保存到IndexedDB，下次自动使用

### v3.8.5.1 (2025-12-09) 📱 导出功能优化
- **新增手机版导出**：新增DOC格式导出按钮，兼容性更好，适合移动端查看
- **4按钮导出系统**：DOCX试题、DOCX答案、DOC试题(手机版)、DOC答案(手机版)
- **统一配置**：4个导出按钮共用一套导出配置和内容选项

### v3.8.5 (2025-12-09) 📱 移动端优化
- **移动端设备检测**：新增User Agent检测，自动识别移动设备
- **差异化等待策略**：手机端固定等待3秒，桌面端保持动态等待
- **提升稳定性**：移动端采用固定等待确保页面充分加载

### v3.8.4.3 (2025-12-09)
- **完全硬编码方案**：移除所有临时变量依赖
- **移除 composed 参数**：避免移动端兼容性问题
- **恢复解锁逻辑**：确保发送按钮在所有环境下可用

### v3.8.4.2 (2025-12-09)
- **改用 Enter 键发送**：替代点击按钮，兼容桌面端和移动端
- **KeyboardEvent 模拟**：同时触发 keydown 和 keyup 事件

### v3.8.4.1 (2025-12-09)
- **添加 GM_deleteValue 授权**：修复缺少权限声明的问题

### v3.8.2 (2025-12-09) 🔧 稳定性优化
- **移除不稳定监听**：移除豆包页面的 500ms 轮询逻辑
- **会话复用**：通过配置会话ID实现稳定可靠的对话复用
- **配置实时读取**：从 IndexedDB 实时读取用户保存的前后缀配置

### v3.8.1 (2025-12-08)
- **AI提问管理选项卡**：新增"🤖 AI提问管理"选项卡
- **前后缀配置**：支持自定义AI提问前缀/后缀提示词
- **实时预览**：配置面板中提供完整的效果预览

### v3.8.0 (2025-12-08) 🎉 重磅更新
- **一键问豆包AI**：新增"🤖 问豆包"按钮，自动提取题目内容并跨域提问
- **智能跨域交互**：使用 GM_setValue/GM_getValue 实现超星与豆包页面的数据传递
- **自动填充发送**：豆包页面自动填充题目到输入框并自动发送
- **会话复用优化**：智能检测已有对话，优先复用而非新建

### v2.7.16 (2025-12-08)
- **图片复制支持**：复制题目时自动包含图片，支持粘贴到 Word
- **HTML 格式复制**：使用 ClipboardItem API 复制富文本格式，保留原始排版
- **固定下边栏**：下边栏紧贴窗口底部，左右延伸无间隙

### v2.7.15 (2025-12-08)
- **代码重构**：新增 DOMHelper 通用 UI 组件工厂方法
- **代码复用**：重构控制面板、设置面板、复制配置等模块的重复代码
- **代码精简**：减少约 200+ 行重复代码，提升可维护性

### v2.7.14 (2025-12-08)
- **紧急修复**：修正保存按钮方法名错误
- **保存按钮已显示**：底部操作栏现在正常显示保存和重置按钮
- **配置持久化修复**：点击保存按钮后配置正确写入 IndexedDB

### v2.7.13 (2025-12-08)
- **修复换行符问题**：修复复制时 `\n` 转义符不生效的 bug
- **添加保存按钮**：新增手动保存配置功能
- **UI 简化**：移除冗余的功能说明区域

### v2.7.12 (2025-12-08)
- **独立配置面板**：将复制配置独立成专用选项卡
- **多行输入支持**：使用 textarea 支持多行前缀/后缀
- **换行符支持**：支持 `\n` 转义符表示换行

### v2.7.11 (2025-12-08)
- **复制配置**：支持为复制的题目内容添加自定义前缀和后缀
- **实时预览**：设置面板中展示前缀/后缀应用效果
- **配置持久化**：前缀和后缀自动保存到 IndexedDB

### v2.7.10 (2025-12-07)
- **修复按钮横向排列问题**：下方布局时确保纵向排列
- **修复空间检测误判**：增加20px安全边距，防止按钮被截断
- **优化空间阈值**：从150px提升到170px

### v2.7.9 (2025-12-07)
- **智能响应式布局**：新增右侧空间检测逻辑
- **动态布局切换**：右侧空间不足时自动移至下方纵向排列
- **平滑过渡效果**：添加 0.3s CSS 过渡动画

### v2.7.4 (2025-12-04)
- **docx 格式导出**：集成 html-docx-js 库，支持真正的 .docx 格式导出
- **智能降级**：库不可用时自动回退到 .doc 格式
- **分割线增强**：题目分割线改为 3px 深灰色粗线

### v2.7.3 (2025-12-04)
- **导出内容选项**：新增 4 个勾选项控制导出内容
- **设置持久化**：导出内容选项保存到 IndexedDB

### v2.7.2 (2025-12-04)
- **修复悬浮栏溢出**：修复底部操作栏导致保存按钮超出窗口的问题
- **按钮位置调整**：交换控制面板和显示全部答案按钮位置
- **排序按钮拆分**：时间排序和字母排序各独立按钮

### v2.7.1 (2025-12-03)
- **尺寸调整**：缩小侧边栏按钮和浮动操作栏尺寸

### v2.7.0 (2025-12-03)
- **统一浮动操作栏**：所有设置面板底部统一样式
- **导出按钮文字优化**：更清晰的导出按钮标识

### v2.6.6 (2025-12-03)
- **导出答案优化**：移除冗余选项内容，只保留答案字母

### v2.6.5 (2025-12-02)
- **双按钮导出**：拆分为「导出试题」和「导出答案」两个按钮

### v2.6.4 (2025-12-02)
- **试题导出功能**：支持导出为 Word 文档
- **图片处理**：自动下载嵌入，超宽自动缩放

### v2.4.0 (2025-11-14)
- **富文本编辑器**：16 个格式按钮
- **编辑/预览模式**：支持预览格式化笔记
- **按钮样式统一**：6 个按钮样式完全统一

### v2.3.0 (2025-11-13)
- **笔记管理增强**：支持多范围筛选
- **样式管理面板**：新增样式管理选项卡
- **样式持久化**：保存到 IndexedDB

### v2.2.0 (2025-11-13)
- **控制面板升级**：左侧边栏设计
- **设置管理**：自动保存开关和延迟配置
- **笔记管理**：批量选择和删除

### v2.1.0 (2025-11-10)
- **笔记功能**：独立添加笔记，支持显示/隐藏
- **IndexedDB 存储**：笔记数据本地持久化
- **自动保存**：可配置的自动保存

### v2.0.0 (2025-11-09)
- **重大重构**：面向对象设计
- **模块化架构**：多个独立模块
- **单一职责原则**：提升可维护性

### v1.0.1
- **油猴脚本支持**
- **单块恢复+全局控制按钮**

### v1.0.0
- **首次发布**
